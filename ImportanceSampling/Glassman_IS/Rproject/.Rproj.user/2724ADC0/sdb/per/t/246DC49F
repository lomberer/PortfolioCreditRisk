{
    "contents" : "Moment Generating Function\n------------\n$$\nM_x(z) \n= G_x(e^z)\n=\\mathbb{E}(e^{zX})\n=\\displaystyle\\sum_{n=0}^{\\infty}\\mathbb{P}[X=n]e^{nz}\n$$\nMGF can generate all the function moments that $\\mathbb{E}[X^q]=M_X^{(q)}(0)$ where $f^{(q)}$ denotes the q-th derivative of function $f$\n\nProof:\n\n$M_X^{(1)}(z)=\\frac{d}{dz}\\mathbb{E}[e^{zX}]=\\mathbb{E}[Xe^{zX}]$\nso\n$M_X^{(1)}(0)=\\mathbb{E}[X]$\n\nCharacteristic Function (Fourier Transform)\n----------------------------------\nCharacteristic function is the Fourier Transform of Density Function\n$$\n\\varphi_X(z)=\\mathbb{E}[e^{izX}]=M_X(iz)=\\int_{-\\infty}^{\\infty}e^{izx}f_X(x)dx=\\int_{-\\infty}^{\\infty}e^{izx}dF_X(x)\n$$\nChracteristic function always exists because $e^{izx}=cos(zx)+i sin(zx)$ are bounded.\n\nConditional Independence\n-----------------\nMixture models depends on conditional independence framwork. \n* Step 1: Draw realization of $y$ of $Y ~ F$\n* Step 2: Generate portfolio loss distirbution:\n$ L|_{Y=y}=\\sum_{i=1}^m E_i(L_i|_{Y=y})$\n* Step 3: Integrate the conditional portfolio loss distribution over the space w.r.t. $F$ of all relization of $y$ of $Y$\n\nFor Step 2, there are 4 alternatives:\n\n* Recurvesive Generation $(CreditRisk^+)$\n\nConstruct the portfolio loss from 1 asset, and recursively add others till $m$ assets\n$$\\mathbb{P}^{(m)}[L=k]=\\mathbb{P}^{(m-1)}[L=k](1-p_m) + \\mathbb{P}^{(m-1)}[L=k-1]p_m$$\n\n* Fourier Tranformation\n\nUse the convolution theorem of Fourier Tranform, convolution is done at characteristic funciton level and use $F^{-1}$ to tranform back.  Fast Fourier Tranformation algorithm is usually used for numerical computation.  As the FFT algorithm works on a lattic, the only problem is to choo se the dsicretization to balance accuracy and performance.\n\n* Saddle-Point Approximation\n\nSaddle-point appriximation is to expande the cumulant generating function.  CGF is defined as $K_L(z)=lnM_L(z)=ln\\mathbb{E}[e^{zL}]=\\sum_{i=1}^m ln M_{E_iL_i}(z)$ where the real stationary point the root $z_0$ with $$K'_L(z_0)=x$$\n$z_0$ is a local minimum at real axis and a local maximum at imaginary axis, hence a saddle point in the complex plane. \nComments on saddle point approximation: 1) we do not need to approximate the density function first and then integrate, but we can apply saddle point directly to object function. 2) the approximation remain a continous approximate and fail to capture the discrete feature of true loss distribution.  \n\n* Importance Sampling\n\nInstead of sampling from $N(0,1)$, sample from shifted normal distirbution $N(\\mu,1)$, where $\\mu<0$ should generate more adverse scenarios of $y$ of $Y$.  To correct such bias from sampling, each scenario has a new likelihood ratio, which is $\\Phi(y)/\\Phi(y-\\mu)$.  \n\nDecompose the variace $\\mathbb{V}[\\hat{F_L}(x)] = \\mathbb{E}[\\mathbb{V}[\\hat{F_L}(x)|Y]] + \\mathbb{V}[\\mathbb{E}[\\hat{F_L}(x)|Y]]$\n\n\nThe first term, for Bernouli loss variable $E_iL_i$ are independent, the likelihood ratio is \n$$\\prod_{i=1}^m (\\frac{p_{i}(Y)}{p_{i,s}(Y)})^{L_i}(\\frac{1-p_i(Y)}{1-p_{i,s}(Y)})^{1-L_i}=exp(-sL+K_L(s))$$ where $K_L(\\theta)$ is CGF of $L$ conditional on $Y$.  The unbiased estimator of $F_L(x)$ under twiseted measure is now $F_L(x)e^{-sL+K_L(s)}$.  The minimum is obtained at $K'_L(s_0)=x=\\mathbb{E}_s[L]$  The second term, the likelihood ratio for such change of measure is $exp(-\\mu^TY+\\frac{\\mu^T\\mu}{2})$\n\nSo the two-step importance sampling estimator for $F_L$ is $$F_L exp\\big(-s_0(Y)L+K_{L|Y}(s_0(Y))-\\mu^TY+\\frac{\\mu^T\\mu}{2}\\big)$$\n\nTo choose the appropriate $\\mu = max\\mathbb{P}[L>x|Y=y]e^{-y^Ty/2}$, and approximation of $\\mathbb{P}[L>x|Y=y]$ should be obtained.  \n\nAlgorithm for Importance Sampling is:\n1. Sample $Y$ ~$N(\\mu,\\Sigma)$\n2. Compute $s_0(Y)$ and the twisted conditional default probabilities $p_{i,s_0}(Y)$\n3. Generate Losses under the twisted conditional distribution\n4. Return the estimator of $F_L exp\\big(-s_0(Y)L+K_{L|Y}(s_0(Y))-\\mu^TY+\\frac{\\mu^T\\mu}{2}\\big)$\n\nUsefull Formula\n----------------------\n* Power series of Exponential function\n$e^z=\\displaystyle\\sum_{n=0}^{\\infty}\\frac{z^n}{n!}$\n",
    "created" : 1413128114713.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2726438766",
    "id" : "246DC49F",
    "lastKnownWriteTime" : 1413237729,
    "path" : "C:/Users/Tinglu/Dropbox/Research/PortfolioCreditRisk/Rproject/CreditModelling.Rmd",
    "project_path" : "CreditModelling.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}